# Clustered map of brute-force attempts
index=rdp sourcetype=rdp_honeypot
| eval lat=coalesce(latitude, lat), lon=coalesce(longitude, lon)
| where isnotnull(lat) AND isnotnull(lon)
| geostats latfield=lat longfield=lon count by country

# Choropleth by country
index=rdp sourcetype=rdp_honeypot
| stats count as attempts by country
| lookup geo_attr_countries Country as country OUTPUT FeatureId
| geom geo_countries featureIdField=FeatureId

# Brute-force detection overlay (â‰¥5 attempts in 10m)
index=rdp sourcetype=rdp_honeypot
| eval _time=strptime(timestamp,"%Y-%m-%d %H:%M:%S")
| bin _time span=1m
| stats count as attempts min(_time) as first max(_time) as last by sourcehost, latitude, longitude, country
| streamstats window=10m time_window=10m sum(attempts) as rolling by sourcehost
| where rolling>=5
| geostats latfield=latitude longfield=longitude count by country
